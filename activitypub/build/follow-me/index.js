(()=>{var e,t={20:(e,t,r)=>{"use strict";var o=r(609),n=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,r){var o,s={},c=null,u=null;for(o in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,o)&&!l.hasOwnProperty(o)&&(s[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===s[o]&&(s[o]=t[o]);return{$$typeof:n,type:e,key:c,ref:u,props:s,_owner:i.current}}},609:e=>{"use strict";e.exports=window.React},612:(e,t,r)=>{"use strict";const o=window.wp.blocks,n=window.wp.primitives;var a=r(848);const i=(0,a.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,a.jsx)(n.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"})});var l=r(609),s=r(942),c=r.n(s);const u=window.wp.blockEditor,p={html:!1,color:{gradients:!0,link:!0,__experimentalDefaultControls:{background:!0,text:!0,link:!0}},__experimentalBorder:{radius:!0,width:!0,color:!0,style:!0},typography:{fontSize:!0,__experimentalDefaultControls:{fontSize:!0}}},f=p;function d({buttonOnly:e=!1,className:t="",...r}){return r.className=c()(t,e?"is-style-button-only":"is-style-default"),r}const v={attributes:{buttonOnly:{type:"boolean",default:!1},buttonText:{type:"string",default:"Follow"},selectedUser:{type:"string",default:"site"}},supports:p,isEligible:({buttonText:e,buttonOnly:t})=>!!e||!!t,migrate({buttonText:e,...t}){const r=(0,o.createBlock)("core/button",{tagName:"button",text:e});return[d(t),[r]]}},m=[{attributes:{selectedUser:{type:"string",default:"site"},buttonOnly:{type:"boolean",default:!1}},supports:f,isEligible:({buttonOnly:e})=>!!e,migrate:d,save(){const e=u.useBlockProps.save(),t=u.useInnerBlocksProps.save(e);return(0,l.createElement)("div",{...t})}},v],y=window.wp.apiFetch;var b=r.n(y);const w=window.wp.i18n,h=window.wp.data,_=window.wp.coreData,g=window.wp.components,E=window.wp.element;function k(){return window._activityPubOptions||{}}function x({name:e}){const{enabled:t}=k(),r=t?.site?"":(0,w.__)("It will be empty in other non-author contexts.","activitypub"),o=(0,w.sprintf)(/* translators: %1$s: block name, %2$s: extra information for non-author context */ /* translators: %1$s: block name, %2$s: extra information for non-author context */
(0,w.__)("This <strong>%1$s</strong> block will adapt to the page it is on, displaying the user profile associated with a post author (in a loop) or a user archive. %2$s","activitypub"),e,r).trim();return(0,l.createElement)(g.Card,null,(0,l.createElement)(g.CardBody,null,(0,E.createInterpolateElement)(o,{strong:(0,l.createElement)("strong",null)})))}const O={avatar:"https://secure.gravatar.com/avatar/default?s=120",webfinger:"@well@hello.dolly",name:(0,w.__)("Hello Dolly Fan Account","activitypub"),url:"#",image:{url:""},summary:""};function S(e){if(!e)return O;const t={...O,...e};return t.avatar=t?.icon?.url,t.webfinger&&!t.webfinger.startsWith("@")&&(t.webfinger="@"+t.webfinger),t}function N({profile:e,className:t,innerBlocksProps:r}){const{webfinger:o,avatar:n,name:a,image:i,summary:s,followers:c,posts:u}=e,p=t&&t.includes("is-style-button-only"),f={posts:u||17,followers:c||0};return(0,l.createElement)("div",{className:"activitypub-profile"},!p&&i?.url&&(0,l.createElement)("div",{className:"activitypub-profile__header",style:{backgroundImage:`url(${i.url})`}}),(0,l.createElement)("div",{className:"activitypub-profile__body"},!p&&(0,l.createElement)("img",{className:"activitypub-profile__avatar",src:n,alt:a}),(0,l.createElement)("div",{className:"activitypub-profile__content"},!p&&(0,l.createElement)("div",{className:"activitypub-profile__info"},(0,l.createElement)("div",{className:"activitypub-profile__name"},a),(0,l.createElement)("div",{className:"activitypub-profile__handle"},o)),(0,l.createElement)("div",{...r}),!p&&(0,l.createElement)("div",{className:"activitypub-profile__bio",dangerouslySetInnerHTML:{__html:s}}),!p&&(0,l.createElement)("div",{className:"activitypub-profile__stats"},Object.entries(f).map((([e,t])=>(0,l.createElement)("div",{key:e},(0,l.createElement)("strong",null,t)," ","posts"===e?(0,w._n)("post","posts",t,"activitypub"):"followers"===e?(0,w._n)("follower","followers",t,"activitypub"):(0,w._n)("following","following",t,"activitypub"))))))))}const B=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","name":"activitypub/follow-me","apiVersion":3,"version":"2.1.0","title":"Follow me on the Fediverse","category":"widgets","description":"Display your Fediverse profile so that visitors can follow you.","textdomain":"activitypub","icon":"groups","example":{"attributes":{"className":"is-style-default"}},"supports":{"html":false,"interactivity":true,"color":{"gradients":true,"link":true,"__experimentalDefaultControls":{"background":true,"text":true,"link":true}},"__experimentalBorder":{"radius":true,"width":true,"color":true,"style":true},"shadow":true,"typography":{"fontSize":true,"__experimentalDefaultControls":{"fontSize":true}},"innerBlocks":{"allowedBlocks":["core/button"]}},"styles":[{"name":"default","label":"Default","isDefault":true},{"name":"button-only","label":"Button"},{"name":"profile","label":"Profile"}],"attributes":{"selectedUser":{"type":"string","default":"site"}},"usesContext":["postType","postId"],"editorScript":"file:./index.js","viewScriptModule":"file:./view.js","viewScript":"wp-api-fetch","style":"file:./style-index.css","render":"file:./render.php"}');(0,o.registerBlockType)(B,{deprecated:m,edit:function({attributes:e,setAttributes:t,context:{postType:r,postId:o}}){const n=(0,u.useBlockProps)({className:"activitypub-follow-me-block-wrapper"}),a=function({withInherit:e=!1}){const{enabled:t}=k(),r=t?.users?(0,h.useSelect)((e=>e("core").getUsers({capabilities:"activitypub"})),[]):[];return(0,E.useMemo)((()=>{if(!r)return[];const o=[];return t?.site&&o.push({label:(0,w.__)("Site","activitypub"),value:"site"}),e&&t?.users&&o.push({label:(0,w.__)("Dynamic User","activitypub"),value:"inherit"}),r.reduce(((e,t)=>(e.push({label:t.name,value:`${t.id}`}),e)),o)}),[r])}({withInherit:!0}),{selectedUser:i,className:s="is-style-default"}=e,c="inherit"===i,[p,f]=(0,E.useState)(S(O)),d="site"===i?0:i,v=[["core/button",{text:(0,w.__)("Follow","activitypub"),tagName:"button"}]],m=(0,u.useInnerBlocksProps)({},{allowedBlocks:["core/button"],template:v,templateLock:!1,renderAppender:!1}),y=(0,h.useSelect)((e=>{const{getEditedEntityRecord:t}=e(_.store),n=t("postType",r,o)?.author;return null!=n?n:null}),[r,o]);return(0,E.useEffect)((()=>{if(c&&!y)return;const e=c?y:d;(function(e){const{namespace:t}=k(),r={headers:{Accept:"application/activity+json"},path:`/${t}/actors/${e}`};return b()(r)})(e).then((t=>{if(f(S(t)),t.followers)try{const{pathname:e}=new URL(t.followers);b()({path:e.replace("wp-json/","")}).then((e=>{const t=e?.totalItems||0;f((e=>({...e,followers:t})))})).catch((()=>{}))}catch(e){}b()({path:`/wp/v2/users/${e}/?context=activitypub`}).then((({post_count:e})=>{f((t=>({...t,posts:e})))})).catch((()=>{}))})).catch((()=>{}))}),[d,y,c]),(0,E.useEffect)((()=>{a.length&&(a.find((({value:e})=>e===i))||t({selectedUser:a[0].value}))}),[i,a]),(0,l.createElement)("div",{...n},(0,l.createElement)(u.InspectorControls,{key:"activitypub-follow-me"},(0,l.createElement)(g.PanelBody,{title:(0,w.__)("Follow Me Options","activitypub")},a.length>1&&(0,l.createElement)(g.SelectControl,{label:(0,w.__)("Select User","activitypub"),value:e.selectedUser,options:a,onChange:e=>t({selectedUser:e}),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}))),c&&!y?(0,l.createElement)(x,{name:(0,w.__)("Follow Me","activitypub")}):(0,l.createElement)(N,{profile:p,className:s,innerBlocksProps:m}))},icon:i,save:function(){const e=u.useBlockProps.save(),t=u.useInnerBlocksProps.save(e);return(0,l.createElement)("div",{...t})}})},848:(e,t,r)=>{"use strict";e.exports=r(20)},942:(e,t)=>{var r;!function(){"use strict";var o={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=i(e,a(r)))}return e}function a(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)o.call(e,r)&&e[r]&&(t=i(t,r));return t}function i(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.m=t,e=[],o.O=(t,r,n,a)=>{if(!r){var i=1/0;for(u=0;u<e.length;u++){for(var[r,n,a]=e[u],l=!0,s=0;s<r.length;s++)(!1&a||i>=a)&&Object.keys(o.O).every((e=>o.O[e](r[s])))?r.splice(s--,1):(l=!1,a<i&&(i=a));if(l){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,n,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={338:0,870:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var n,a,[i,l,s]=r,c=0;if(i.some((t=>0!==e[t]))){for(n in l)o.o(l,n)&&(o.m[n]=l[n]);if(s)var u=s(o)}for(t&&t(r);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(u)},r=globalThis.webpackChunkwordpress_activitypub=globalThis.webpackChunkwordpress_activitypub||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var n=o.O(void 0,[870],(()=>o(612)));n=o.O(n)})();